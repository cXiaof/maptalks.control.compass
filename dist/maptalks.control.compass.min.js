/*!
 * maptalks.control.compass v0.2.0
 * LICENSE : MIT
 * (c) 2016-2023 maptalks.org
 */
/*!
 * requires maptalks@>=0.31.0 
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.maptalks=t.maptalks||{})}(this,function(t){"use strict";function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);if(t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e)if(Object.setPrototypeOf)Object.setPrototypeOf(t,e);else for(var o=t,i=e,s=Object.getOwnPropertyNames(i),n=0;n<s.length;n++){var r=s[n],a=Object.getOwnPropertyDescriptor(i,r);a&&a.configurable&&void 0===o[r]&&Object.defineProperty(o,r,a)}}e(s,o=maptalks.control.Control),s.prototype.buildOn=function(){var t=this._getCompass(),e=(this._compass=t,this.options.transform),o="background-color: "+this.options.backgroundColor+";";return e&&(o+=" transform: "+e+";"),maptalks.DomUtil.setStyle(this._compass,o),this._bindResetViewTrigger(),t},s.prototype.onAdd=function(){this.map=this.getMap(),this.map.on("animating mousemove touchmove",this._rotateCompass,this),this._rotateCompass()},s.prototype.onRemove=function(){this.map.off("animating mousemove touchmove",this._rotateCompass,this),this._compass.remove(),delete this._compass,delete this._bearing,delete this._needle,delete this.map},s.prototype._rotateCompass=function(){var t=this.map.getBearing().toFixed(1);t<=180&&(t*=-1),t!==this._bearing&&(this._bearing=t,maptalks.DomUtil.setStyle(this._needle,"transform: rotate("+this._bearing+"deg);"))},s.prototype._getCompass=function(){var t=this._createDivWithClassName(this.COMPASS),e=this._getDial(),o=this._getNeedle();return t.appendChild(e),t.appendChild(o),this._bindEventListener(t),t},s.prototype._getDial=function(){for(var t=this._createDivWithClassName(this.DIAL),e=0;e<4;e++){var o=this._getClock();t.appendChild(o)}return t},s.prototype._getClock=function(){return this._createDivWithClassName(this.CLOCK)},s.prototype._getNeedle=function(){var t=this._createDivWithClassName(this.NEEDLE);return this._needle=t},s.prototype._createDivWithClassName=function(t){return maptalks.DomUtil.createEl("div",t)},s.prototype._bindEventListener=function(t){var e=this;t.onclick=function(t){e.fire("click",{domEvent:t})},t.ondblclick=function(t){e.fire("dblclick",{domEvent:t})},t.oncontextmenu=function(t){e.fire("contextmenu",{domEvent:t})}},s.prototype._bindResetViewTrigger=function(){var t,e,o=this.options.resetViewTriggers;o&&(t="",e=void 0,"string"==typeof o?t=o:Array.isArray(o)&&(t=o[0],e=o[1]),this.on(t,this._resetView.bind(this,e)))},s.prototype._resetView=function(t){this.map.animateTo({pitch:0,bearing:0},t)};var o,i=s;function s(t){if(this instanceof s)return(t=function(t,e){if(t)return!e||"object"!=typeof e&&"function"!=typeof e?t:e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,o.call(this,t))).COMPASS="maptalks-compass",t.DIAL="maptalks-compass-dial",t.NEEDLE="maptalks-compass-needle",t.CLOCK="maptalks-compass-dial-clock",t;throw new TypeError("Cannot call a class as a function")}i.mergeOptions({position:"top-right",backgroundColor:"#172029",transform:"",resetViewTriggers:null}),t.CompassControl=i,Object.defineProperty(t,"__esModule",{value:!0}),"undefined"!=typeof console&&console.log("maptalks.control.compass v0.2.0, requires maptalks@>=0.31.0.")});